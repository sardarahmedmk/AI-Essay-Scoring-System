<!DOCTYPE html>
<html>
<head>
    <title>🚀 Advanced Essay Scoring & Enhancement System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        textarea { 
            width: 100%; 
            height: 300px; 
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        button { 
            padding: 12px 20px; 
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #ffecd2, #fcb69f);
            color: #333;
        }

        .btn-success {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            color: #333;
        }

        .btn-info {
            background: linear-gradient(135deg, #84fab0, #8fd3f4);
            color: #333;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:disabled {
            opacity: 0.6;
            transform: none;
            cursor: not-allowed;
        }

        .results { 
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .score-display {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            font-size: 2.5rem;
            font-weight: bold;
        }

        .score-excellent { background: linear-gradient(135deg, #11998e, #38ef7d); color: white; }
        .score-good { background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; }
        .score-average { background: linear-gradient(135deg, #fa709a, #fee140); color: white; }
        .score-poor { background: linear-gradient(135deg, #ff6a6a, #ee0979); color: white; }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        .suggestions-section {
            background: rgba(255, 248, 220, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }

        .suggestion-item {
            background: white;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 3px solid #28a745;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .best-essay-section {
            background: rgba(220, 248, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #17a2b8;
        }

        .best-essay-preview {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid #e0e0e0;
            font-style: italic;
            max-height: 200px;
            overflow-y: auto;
        }

        .word-counter {
            text-align: right;
            color: #666;
            font-size: 14px;
            margin: 5px 0;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .enhancement-tips {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .tip-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            padding: 8px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 5px;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                justify-content: center;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-robot"></i> Advanced Essay Scoring & Enhancement System</h1>
            <p>Get instant scoring, personalized suggestions, and see examples of excellent essays</p>
        </div>

        <div class="main-grid">
            <div class="card">
                <h3><i class="fas fa-edit"></i> Write Your Essay</h3>
                <textarea id="essay" placeholder="✍️ Start writing your essay here...

Tips for better scoring:
• Write at least 150 words
• Use varied vocabulary
• Include clear introduction, body, and conclusion
• Check for grammar and spelling errors
• Use transition words between paragraphs">Education is very important for everyone. It helps people develop knowledge and skills. Students should work hard to achieve their goals. Teachers play a vital role in the learning process.</textarea>
                
                <div class="word-counter" id="word-counter">Words: 0 | Characters: 0</div>
                
                <div class="button-group">
                    <button class="btn-primary" onclick="scoreEssay()">
                        <i class="fas fa-magic"></i> Score & Analyze
                    </button>
                    <button class="btn-secondary" onclick="loadSample()">
                        <i class="fas fa-lightbulb"></i> Load Sample
                    </button>
                    <button class="btn-info" onclick="getSuggestions()">
                        <i class="fas fa-tips"></i> Get Suggestions
                    </button>
                    <button class="btn-success" onclick="showBestEssay()">
                        <i class="fas fa-star"></i> Show Best Essay
                    </button>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-chart-line"></i> Essay Enhancement Tips</h3>
                <div class="enhancement-tips">
                    <div class="tip-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span>Use varied sentence structures (short, medium, long)</span>
                    </div>
                    <div class="tip-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span>Include specific examples and evidence</span>
                    </div>
                    <div class="tip-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span>Use transition words (however, therefore, furthermore)</span>
                    </div>
                    <div class="tip-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span>Avoid repetitive vocabulary</span>
                    </div>
                    <div class="tip-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span>Ensure clear topic sentences in each paragraph</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="loading-spinner" id="loading">
            <div class="spinner"></div>
            <p>Analyzing your essay with AI...</p>
        </div>

        <div id="results" class="results" style="display: none;">
            <h3><i class="fas fa-chart-bar"></i> Essay Analysis Results</h3>
            
            <div class="score-display" id="score-display">
                <div class="score-value">0/10</div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value" id="word-count">0</div>
                    <div class="metric-label">Word Count</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="sentences">0</div>
                    <div class="metric-label">Sentences</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="unique-words">0</div>
                    <div class="metric-label">Unique Words</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="vocab-diversity">0</div>
                    <div class="metric-label">Vocabulary Diversity</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="avg-sentence">0</div>
                    <div class="metric-label">Avg Sentence Length</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="readability">0</div>
                    <div class="metric-label">Readability Score</div>
                </div>
            </div>

            <div>
                <h4><i class="fas fa-comment-dots"></i> AI Feedback</h4>
                <div id="feedback" style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 8px; margin: 10px 0;">
                    Your feedback will appear here...
                </div>
            </div>
        </div>

        <div id="suggestions" class="suggestions-section" style="display: none;">
            <h4><i class="fas fa-lightbulb"></i> Personalized Improvement Suggestions</h4>
            <div id="suggestions-list"></div>
        </div>

        <div id="best-essay" class="best-essay-section" style="display: none;">
            <h4><i class="fas fa-star"></i> Example of Excellent Essay</h4>
            <p><strong>Score: 9.5/10</strong> - Here's an example of a high-scoring essay on a similar topic:</p>
            <div class="best-essay-preview" id="best-essay-content"></div>
            <button class="btn-info" onclick="copyBestEssay()" style="margin-top: 10px;">
                <i class="fas fa-copy"></i> Copy to Editor
            </button>
        </div>
    </div>
    <script>
        let sampleEssays = [];
        let bestEssays = [
            {
                topic: "Education",
                text: `Education serves as the cornerstone of personal development and societal progress. In today's rapidly evolving world, the importance of quality education cannot be overstated, as it shapes not only individual futures but also the collective destiny of nations.

Firstly, education empowers individuals with critical thinking skills essential for navigating complex challenges. Through rigorous academic training, students learn to analyze information, evaluate evidence, and formulate well-reasoned arguments. For instance, students studying science develop hypothesis-testing abilities that prove invaluable in professional problem-solving scenarios.

Moreover, education fosters innovation and creativity by exposing learners to diverse perspectives and methodologies. Universities and educational institutions serve as incubators for groundbreaking research and technological advancement. The collaboration between students and faculty often leads to discoveries that revolutionize entire industries.

Furthermore, education promotes social mobility and equality by providing opportunities regardless of socioeconomic background. Scholarship programs and accessible learning platforms ensure that talented individuals can pursue their aspirations despite financial constraints. This democratization of knowledge strengthens society's fabric by utilizing human potential more effectively.

In conclusion, education remains humanity's most powerful tool for progress. By investing in comprehensive educational systems, societies ensure sustainable development, innovation, and equality for future generations. The transformative power of education extends far beyond individual achievement, creating ripples of positive change throughout communities worldwide.`,
                score: 9.5
            },
            {
                topic: "Technology",
                text: `The digital revolution has fundamentally transformed human civilization, reshaping how we communicate, work, and perceive reality. As we stand at the threshold of unprecedented technological advancement, it becomes crucial to examine both the profound benefits and potential challenges that technology presents to society.

Technology has democratized access to information and education on an unprecedented scale. Online learning platforms, digital libraries, and educational applications have made knowledge accessible to millions who previously lacked such opportunities. Students in remote areas can now attend virtual lectures from world-renowned institutions, breaking down geographical barriers to quality education.

Additionally, technological innovations have revolutionized healthcare delivery and outcomes. Telemedicine enables doctors to diagnose and treat patients across vast distances, while artificial intelligence assists in early disease detection and personalized treatment plans. Medical devices and digital health monitoring systems have empowered individuals to take proactive control of their well-being.

However, the rapid pace of technological change also presents significant challenges. Privacy concerns, digital addiction, and the potential displacement of traditional employment require careful consideration and proactive solutions. Society must develop frameworks that harness technology's benefits while mitigating its risks.

In conclusion, technology represents both humanity's greatest opportunity and its most complex challenge. By fostering responsible innovation, promoting digital literacy, and maintaining human-centered values, we can ensure that technological progress serves the greater good while preserving the qualities that make us fundamentally human.`,
                score: 9.8
            }
        ];
        
        // Load samples on page load
        fetch('/samples')
            .then(response => response.json())
            .then(data => {
                sampleEssays = data.samples;
                console.log('Loaded samples:', sampleEssays.length);
            })
            .catch(error => console.error('Error loading samples:', error));

        // Word counter functionality
        document.getElementById('essay').addEventListener('input', function() {
            const text = this.value;
            const words = text.trim() ? text.trim().split(/\s+/).length : 0;
            const chars = text.length;
            document.getElementById('word-counter').textContent = `Words: ${words} | Characters: ${chars}`;
        });

        // Initialize word counter
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('essay').dispatchEvent(new Event('input'));
        });
        
        function loadSample() {
            if (sampleEssays.length > 0) {
                const randomIndex = Math.floor(Math.random() * sampleEssays.length);
                document.getElementById('essay').value = sampleEssays[randomIndex].text;
                document.getElementById('essay').dispatchEvent(new Event('input'));
                console.log('Sample loaded');
            } else {
                alert('No samples available. Please make sure the server is running.');
            }
        }
        
        function scoreEssay() {
            const text = document.getElementById('essay').value;
            const resultsDiv = document.getElementById('results');
            const loadingDiv = document.getElementById('loading');
            
            if (!text.trim()) {
                alert('Please enter some text');
                return;
            }
            
            // Show loading
            loadingDiv.style.display = 'block';
            resultsDiv.style.display = 'none';
            
            console.log('Scoring essay with', text.length, 'characters');
            
            fetch('/score', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: text })
            })
            .then(response => {
                console.log('Response status:', response.status);
                return response.json();
            })
            .then(result => {
                console.log('Full result:', result);
                
                // Hide loading
                loadingDiv.style.display = 'none';
                
                if (result.error) {
                    alert('Error: ' + result.error);
                    return;
                }
                
                // Enhanced metrics calculation
                const words = text.trim().split(/\s+/);
                const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
                const uniqueWords = new Set(words.map(w => w.toLowerCase().replace(/[^\w]/g, ''))).size;
                const vocabularyDiversity = Math.round((uniqueWords / words.length) * 100);
                const avgSentenceLength = Math.round(words.length / sentences.length);
                const readabilityScore = Math.min(10, Math.max(1, Math.round(10 - (avgSentenceLength - 15) * 0.2)));
                
                // Display score with styling
                const scoreDisplay = document.getElementById('score-display');
                const scoreValue = result.score;
                scoreDisplay.innerHTML = `<div class="score-value">${scoreValue}/10</div>`;
                
                // Apply score-based styling
                scoreDisplay.className = 'score-display ';
                if (scoreValue >= 8) scoreDisplay.className += 'score-excellent';
                else if (scoreValue >= 6) scoreDisplay.className += 'score-good';
                else if (scoreValue >= 4) scoreDisplay.className += 'score-average';
                else scoreDisplay.className += 'score-poor';
                
                // Show enhanced metrics
                document.getElementById('word-count').textContent = result.metrics.word_count;
                document.getElementById('sentences').textContent = result.metrics.sentence_count;
                document.getElementById('unique-words').textContent = uniqueWords;
                document.getElementById('vocab-diversity').textContent = vocabularyDiversity + '%';
                document.getElementById('avg-sentence').textContent = avgSentenceLength;
                document.getElementById('readability').textContent = readabilityScore + '/10';
                document.getElementById('feedback').textContent = result.feedback;
                
                resultsDiv.style.display = 'block';
                
                console.log('Results displayed successfully');
            })
            .catch(error => {
                loadingDiv.style.display = 'none';
                console.error('Error:', error);
                alert('Scoring failed: ' + error.message);
            });
        }

        function getSuggestions() {
            const text = document.getElementById('essay').value;
            const suggestionsDiv = document.getElementById('suggestions');
            const suggestionsList = document.getElementById('suggestions-list');
            
            if (!text.trim()) {
                alert('Please enter some text first');
                return;
            }

            // Analyze text and generate suggestions
            const words = text.trim().split(/\s+/);
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
            const suggestions = [];

            // Word count suggestions
            if (words.length < 150) {
                suggestions.push({
                    icon: 'fas fa-expand-arrows-alt',
                    text: 'Your essay is quite short. Consider adding more detailed examples and explanations to reach at least 150 words for better scoring.'
                });
            } else if (words.length > 500) {
                suggestions.push({
                    icon: 'fas fa-compress-arrows-alt',
                    text: 'Your essay is quite long. Consider being more concise and focused on your main arguments.'
                });
            }

            // Sentence variety
            const avgSentenceLength = words.length / sentences.length;
            if (avgSentenceLength < 10) {
                suggestions.push({
                    icon: 'fas fa-text-width',
                    text: 'Try using longer, more complex sentences to show advanced writing skills. Combine related ideas with conjunctions.'
                });
            } else if (avgSentenceLength > 25) {
                suggestions.push({
                    icon: 'fas fa-cut',
                    text: 'Some sentences are very long. Break them into shorter ones for better readability.'
                });
            }

            // Vocabulary diversity
            const uniqueWords = new Set(words.map(w => w.toLowerCase().replace(/[^\w]/g, ''))).size;
            const diversity = uniqueWords / words.length;
            if (diversity < 0.6) {
                suggestions.push({
                    icon: 'fas fa-book',
                    text: 'Try using more varied vocabulary. Replace repeated words with synonyms to show language sophistication.'
                });
            }

            // Structure suggestions
            if (!text.toLowerCase().includes('firstly') && !text.toLowerCase().includes('first') && 
                !text.toLowerCase().includes('secondly') && !text.toLowerCase().includes('finally')) {
                suggestions.push({
                    icon: 'fas fa-list-ol',
                    text: 'Use transition words like "Firstly", "Moreover", "Furthermore", "In conclusion" to improve essay structure.'
                });
            }

            // Introduction/conclusion check
            if (!text.toLowerCase().includes('conclusion') && !text.toLowerCase().includes('in summary')) {
                suggestions.push({
                    icon: 'fas fa-flag-checkered',
                    text: 'Consider adding a clear conclusion that summarizes your main points.'
                });
            }

            // Examples suggestion
            if (!text.toLowerCase().includes('example') && !text.toLowerCase().includes('instance')) {
                suggestions.push({
                    icon: 'fas fa-lightbulb',
                    text: 'Include specific examples to support your arguments and make them more convincing.'
                });
            }

            // Display suggestions
            if (suggestions.length === 0) {
                suggestions.push({
                    icon: 'fas fa-check-circle',
                    text: 'Great job! Your essay follows good writing practices. Consider adding more sophisticated vocabulary for even better scoring.'
                });
            }

            suggestionsList.innerHTML = suggestions.map(suggestion => `
                <div class="suggestion-item">
                    <i class="${suggestion.icon}" style="color: #28a745; margin-right: 10px;"></i>
                    ${suggestion.text}
                </div>
            `).join('');

            suggestionsDiv.style.display = 'block';
        }

        function showBestEssay() {
            const bestEssayDiv = document.getElementById('best-essay');
            const bestEssayContent = document.getElementById('best-essay-content');
            
            // Select a random best essay
            const randomBestEssay = bestEssays[Math.floor(Math.random() * bestEssays.length)];
            
            bestEssayContent.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Topic:</strong> ${randomBestEssay.topic} | 
                    <strong>Score:</strong> ${randomBestEssay.score}/10
                </div>
                <div style="line-height: 1.6;">
                    ${randomBestEssay.text.split('\n\n').map(paragraph => 
                        `<p style="margin-bottom: 15px;">${paragraph}</p>`
                    ).join('')}
                </div>
            `;
            
            bestEssayDiv.style.display = 'block';
        }

        function copyBestEssay() {
            const bestEssayContent = document.getElementById('best-essay-content');
            const bestEssayText = bestEssays[Math.floor(Math.random() * bestEssays.length)].text;
            
            document.getElementById('essay').value = bestEssayText;
            document.getElementById('essay').dispatchEvent(new Event('input'));
            
            // Scroll to essay textarea
            document.getElementById('essay').scrollIntoView({ behavior: 'smooth' });
            
            alert('Best essay copied to editor! You can now modify it or analyze it.');
        }

        // Auto-hide results when typing
        document.getElementById('essay').addEventListener('input', function() {
            if (this.value.trim() === '') {
                document.getElementById('results').style.display = 'none';
                document.getElementById('suggestions').style.display = 'none';
                document.getElementById('best-essay').style.display = 'none';
            }
        });
    </script>
</body>
</html>
